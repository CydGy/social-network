/*

Should I need to store in a database?
TODO yes!!!!!!111

sockets = {
  ip: [ {}, {}, {} ],
  ip: [ {}, {}, {} ]
};

*/


var sockets = exports.sockets = {};


exports.add = function (socket) {

  var ip = socket.remoteAddress;
  if ( !sockets[ip] ) sockets[ip] = [];
  var arrayRef = sockets[ip];

  arrayRef.push(socket);

  socket.on('close', function () {

    arrayRef.splice(arrayRef.indexOf(socket), 1);
    if ( !arrayRef[0] ) delete arrayRef;

  });

};


exports.removeAll = function () {

  var prop, i, c, count = 0;

  for (prop in sockets) {

    for (i = 0, c = sockets[prop].length; i < c; i++) {

      sockets[prop][i].destroy();
      count++;

    }

  }

  return count;

};

exports.removeUID = function (ip) {

  var arrayRef = sockets[ip];

  for (var i = 0, c = arrayRef.length; i < c; i++) {
    arrayRef[i].user_id = undefined;
    arrayRef[i].userId = undefined;
  }

};
