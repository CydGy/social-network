(function (exports) {

  // https://github.com/christo/validator.js
  var emailRegexp1 = /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;

  // http://www.w3.org/TR/html51/forms.html#e-mail-state-(type=email)
  var emailRegexp2 = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;

  // https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms/Data_form_validation#Example_that_doesn't_use_the_constraint_validation_API
  // As per the HTML5 Specification
  var emailRegexp3 = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;

  // Perso
  var emailRegexp4 = /^[a-zA-Z0-9._+-]+@[a-zA-Z0-9._+-]+\.[a-zA-Z]{2,6}$/;

  // http://www.regular-expressions.info/email.html
  var emailRegexp5 = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;
  var emailRegexp6 = /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i;


  exports.email = function (str) {
    return typeof str === 'string'
        && str.length >= 3
        && str.length <= 300
        && emailRegexp1.test(str)
        && ! /@socialnetwork\.com$/.test(str);
  };

  exports.password = function (str) {
    return typeof str === 'string'
        && str.length >= 4
        && str.length <= 50;
  };

  exports.username = function (str) { 
    return typeof str === 'string' && /^[A-Za-z0-9]{1,15}$/.test(str);
  };

  exports.contactMessage = function (str) {
    return typeof str === 'string'
      && str.length >= 1
      && str.length <= 2000;
  };

  exports.code = function (str) { 
    return typeof str === 'string' && /^[A-Za-z0-9]{4,40}$/.test(str);
  };

  exports.token = exports.code;
  exports.authenticity_token = exports.code;

  exports.id = function (str) { 
    // ObjectID.isValid(5) // true
    return typeof str === 'string' && /^[0-9a-fA-F]{24}$/.test(str);
  };

  exports.int = function (str) {
    return typeof str === 'string' && /^[0-9]+$/.test(str);
  };

  exports.useragent = function (str) {
    return typeof str === 'string'
        && str.length >= 1
        && str.length <= 500;
  };

  exports.lang = function (str) {

    if (str === 'fr' || str === 'en') return true;

  };

})(typeof exports === 'undefined' ? this['valid'] = {} : exports);
